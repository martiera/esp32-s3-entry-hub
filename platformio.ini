; ESP32-S3 Entry Hub - Advanced Voice-Controlled Access Panel
; PlatformIO Project Configuration File
; Hardware: ESP32-S3 N16R8 (16MB Flash + 8MB PSRAM)
; Display: 3.5" ILI9488 480x320 IPS + FT6236 Touch

[env:esp32-s3-devkitc-1]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

; Upload settings
upload_speed = 921600
monitor_speed = 115200

; Board configuration for N16R8 (16MB Flash + 8MB Octal PSRAM)
board_build.flash_size = 16MB
board_upload.flash_size = 16MB
board_build.arduino.memory_type = qio_opi
board_build.psram_type = opi

; Build flags
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1
    -DBOARD_HAS_PSRAM=1
    -D CONFIG_SPIRAM_CACHE_WORKAROUND
    -D CONFIG_PM_ENABLE=0
    -DHTTP_DOWNLOAD_UNIT_SIZE=1436
    -DWIFIMANAGER_OVERRIDE_STRINGS
    -Wno-macro-redefined
    ; TFT_eSPI configuration for ESP32-S3
    -DUSER_SETUP_LOADED=1
    -DILI9488_DRIVER=1
    -DTFT_WIDTH=320
    -DTFT_HEIGHT=480
    -DTFT_MOSI=11
    -DTFT_MISO=13
    -DTFT_SCLK=12
    -DTFT_CS=10
    -DTFT_DC=8
    -DTFT_RST=9
    -DTFT_BL=46
    -DUSE_HSPI_PORT=1
    -DSPI_FREQUENCY=40000000
    -DSPI_READ_FREQUENCY=20000000
    -DTOUCH_CS=-1
    -DLOAD_GLCD=1
    -DLOAD_FONT2=1
    -DLOAD_FONT4=1
    -DLOAD_FONT6=1
    -DLOAD_FONT7=1
    -DLOAD_FONT8=1
    -DLOAD_GFXFF=1
    -DSMOOTH_FONT=1
    ; LVGL configuration - use include path for lv_conf.h
    -DLV_CONF_INCLUDE_SIMPLE
    -DLV_TICK_PERIOD_MS=5
    -I${PROJECT_DIR}/include

; Partition scheme for 16MB flash with OTA
board_build.partitions = default_16MB.csv
board_build.filesystem = littlefs

; Libraries
lib_deps = 
    ; WiFi and Network
    bblanchon/ArduinoJson@^7.2.1
    knolleary/PubSubClient@^2.8
    mathieucarbou/ESPAsyncWebServer @ 3.6.0
    
    ; Configuration and Storage
    https://github.com/tzapu/WiFiManager.git
    
    ; Time and utilities
    arduino-libraries/NTPClient@^3.2.1
    adafruit/Adafruit BusIO@^1.14.1
    
    ; Display
    bodmer/TFT_eSPI@^2.5.43
    lvgl/lvgl@^8.3.11
    
    ; RGB LED
    fastled/FastLED@^3.7.0
    
    ; Touch - FT6236 capacitive touch
    https://github.com/strange-v/FT6X36.git

; Extra scripts
extra_scripts = 
    pre:scripts/build_data.py
